# Response to Document Review #2

**Feature**: spec-productivity-metrics
**Review Date**: 2025-12-27
**Reply Date**: 2025-12-27

---

## Response Summary

| Severity | Issues | Fix Required | No Fix Needed | Needs Discussion |
| -------- | ------ | ------------ | ------------- | ---------------- |
| Critical | 0      | -            | -             | -                |
| Warning  | 1      | 0            | 1             | 0                |
| Info     | 4      | 0            | 4             | 0                |

---

## Response to Warnings

### W1: イベントリスナー統合詳細

**Issue**: Design/Tasksにて「WorkflowView、DocsTabs等のコンポーネントにイベントハンドラを追加」とあるが、どのコンポーネントにどのイベントタイプを追加するかの詳細が不明確。

**Judgment**: **No Fix Needed** ❌

**Evidence**:

既存コードベースを調査した結果、イベントポイントは明確に特定できる。

**WorkflowView.tsx** (675行):
- `handleExecutePhase`, `handleApprovePhase` などのフェーズ操作ハンドラが存在
- `PhaseItem` コンポーネントに `onExecute`, `onApprove` 等のコールバックを渡している
- これらの既存ハンドラにHumanActivityTracker呼び出しを追加するのが自然な統合点

**DocsTabs.tsx** (169行):
- `handleTabChange` でタブ切替イベントを処理
- `handleCreateClick` で作成ボタンクリックを処理
- これらの既存ハンドラにHumanActivityTracker呼び出しを追加可能

**PhaseItem.tsx** (283行):
- `onExecute`, `onApprove`, `onApproveAndExecute`, `onShowAgentLog` 等のコールバックが定義
- ボタンクリックイベントはWorkflowView経由で処理

**具体的な統合ポイント**:

| イベントタイプ | コンポーネント | 統合箇所 |
|---------------|---------------|----------|
| `spec-select` | SpecList/specStore | `selectSpec()` 呼び出し時 |
| `artifact-tab-change` | DocsTabs | `handleTabChange()` |
| `document-scroll` | DocsTabsContent/MarkdownViewer | `onScroll` イベントリスナー |
| `agent-log-scroll` | AgentLogViewer | `onScroll` イベントリスナー |
| `agent-log-expand` | AgentLogViewer | 展開ボタンクリック時 |
| `approval-button` | WorkflowView | `handleApprovePhase()` |
| `link-click` | MarkdownViewer | リンククリック時 |
| `text-select` | 各コンポーネント | `onSelect` イベントリスナー |

これらは実装時に既存コンポーネント構造から容易に特定可能であり、Design/Tasksを修正する必要はない。Task 3.3の記述「WorkflowView、DocsTabs等のコンポーネントにイベントハンドラを追加」は実装時の指針として十分。

---

## Response to Info (Low Priority)

| #  | Issue | Judgment | Reason |
|----|-------|----------|--------|
| I1 | イベントdebounce間隔 | No Fix Needed | 100msはハードコード可。将来調整が必要になれば定数化 |
| I2 | specStore.selectedSpec変更時の自動リロード | No Fix Needed | 既存パターンで確立済み（useEffect + subscribe） |
| I3 | プロジェクト横断メトリクス（Task 8）スコープ | No Fix Needed | オプショナルとして明記済み、初期スコープ外で適切 |
| I4 | E2Eテストシナリオ詳細化 | No Fix Needed | Task 9.2実装時に具体化する方針で問題なし |

---

## Files to Modify

| File | Changes |
|------|---------|
| なし | 修正不要 |

---

## Conclusion

レビュー#2で指摘されたWarning 1件（イベントリスナー統合詳細）について調査した結果、既存コードベースから統合ポイントは明確に特定可能であり、Design/Tasksの修正は不要と判断。

Info 4件についても、すべて現状の記述で問題なく、実装時の判断事項として適切。

**次のステップ**: すべてのIssueが解決済み（No Fix Needed）のため、実装フェーズに進むことを推奨。

```
/kiro:spec-impl spec-productivity-metrics
```

---

_This reply was generated by the document-review-reply command._
