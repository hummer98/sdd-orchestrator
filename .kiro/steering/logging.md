# Logging Guideline

ロギングに関する設計/実装の観点・ガイドライン。言語/フレームワーク非依存の観点を定義する。

## 必須観点 (Critical)

### ログレベル対応

アプリケーションは以下のログレベルをサポートすること:

| レベル | 用途 | 例 |
|--------|------|-----|
| debug | 開発時のデバッグ情報 | 変数値、関数呼び出しトレース |
| info | 正常系の動作記録 | 処理開始/完了、ユーザーアクション |
| warning | 潜在的な問題の警告 | 非推奨APIの使用、リトライ発生 |
| error | エラー発生時の詳細 | 例外発生、処理失敗 |

### ログフォーマット

AIアシスタントがログを正確に解析できるフォーマットを採用すること。

**推奨フォーマット例**:
```
[YYYY-MM-DD HH:mm:ss.SSS] [LEVEL] [component] message
```

**構造化ログ（JSON lines）**も有効な選択肢:
```json
{"timestamp":"2025-01-01T12:00:00.000Z","level":"ERROR","component":"auth","message":"Login failed","userId":"123"}
```

### ログ場所の言及

ログファイルの保存場所を以下のいずれかに記載すること:
- `.kiro/steering/debugging.md`
- `CLAUDE.md`

これにより、AIアシスタントがデバッグ時にログを参照できる。

### 過剰なログ実装の回避

- ループ内での過剰なログ出力を避ける
- 大量のデータをログに含めない
- 機密情報（パスワード、トークン、個人情報等）をログに出力しない

## 推奨観点 (Warning)

### 開発/本番ログ出力先分離

開発中のログと本番ログを分離し、調査時の混乱を防止:

| 環境 | 出力先 |
|------|--------|
| 開発 | プロジェクト配下のディレクトリ（例: `./logs/`） |
| 本番 | システム標準のログディレクトリ（例: `~/Library/Logs/`） |

### ログレベル指定手段

以下のいずれかの方法でログレベルを指定可能にすること:
- CLI引数（例: `--log-level=debug`）
- 環境変数（例: `LOG_LEVEL=debug`）
- 設定ファイル（例: `config.json`の`logLevel`フィールド）

### 調査用変数のログ出力

エラー発生時に調査に必要なコンテキスト情報をログに含める:
- リクエスト/レスポンスの識別子
- ユーザーID（マスキング推奨）
- 処理対象のリソースID
- エラー発生時のスタックトレース

## 参照

- **デバッグ手順**: `.kiro/steering/debugging.md`
- **プロジェクト固有のログ設定**: 各プロジェクトの`debugging.md`に記載
